<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>éœ€æ±‚ç®¡ç†çœ‹æ¿</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #f0f2f5; 
            margin: 0; 
            padding: 30px; 
            color: #1a1a1a;
        }
        
        .header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            margin-bottom: 25px; 
            max-width: 1100px;
            margin-left: auto; 
            margin-right: auto;
        }
        
        h2 { font-size: 24px; font-weight: 700; color: #2d3748; }

        .card {
            background: white;
            border-radius: 16px;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            padding: 20px;
            max-width: 1100px;
            margin: 0 auto;
            overflow: hidden;
        }

        table { width: 100%; border-collapse: collapse; }
        
        th { 
            text-align: left; 
            padding: 16px; 
            color: #718096; 
            font-weight: 600; 
            font-size: 13px; 
            text-transform: uppercase; 
            letter-spacing: 0.5px;
            border-bottom: 2px solid #edf2f7;
        }
        
        td { 
            padding: 16px; 
            border-bottom: 1px solid #edf2f7; 
            font-size: 14px; 
            color: #4a5568;
        }
        
        tr:last-child td { border-bottom: none; }
        tr:hover { background-color: #f7fafc; }

        /* æ ‡ç­¾æ ·å¼ */
        .tag-system {
            background-color: #ebf8ff;
            color: #3182ce;
            padding: 4px 10px;
            border-radius: 6px;
            font-weight: 600;
            font-size: 12px;
        }

        .tag-priority {
            padding: 4px 10px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }
        .p-low { background: #f0fff4; color: #38a169; }
        .p-medium { background: #fffaf0; color: #dd6b20; }
        .p-high { background: #fff5f5; color: #e53e3e; }

        /* æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            font-size: 14px;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 2px 10px rgba(118, 75, 162, 0.3);
        }
        .btn-primary:hover { transform: translateY(-1px); box-shadow: 0 4px 12px rgba(118, 75, 162, 0.4); }
        
        .btn-logout { background: white; border: 1px solid #e2e8f0; color: #718096; }
        .btn-logout:hover { background: #f7fafc; color: #2d3748; }

    </style>
</head>
<body>

<div class="header">
    <h2>ğŸ“Š IT éœ€æ±‚æ€»è§ˆ</h2>
    <div style="display: flex; gap: 10px;">
        <a href="create.html" class="btn btn-primary">
            <span>+</span> æéœ€æ±‚
        </a>
        <button onclick="logout()" class="btn btn-logout">é€€å‡º</button>
    </div>
</div>

<div class="card">
    <table id="reqTable">
        <thead>
            <tr>
                <th width="20%">éœ€æ±‚æ ‡é¢˜</th>
                <th width="15%">ç³»ç»Ÿåˆ†ç±»</th>
                <th width="10%">ä¼˜å…ˆçº§</th>
                <th width="30%">æè¿°</th>
                <th width="10%">æäº¤äºº</th>
                <th width="15%">æ—¥æœŸ</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            <!-- JS æ¸²æŸ“ -->
        </tbody>
    </table>
    <div id="emptyState" style="text-align: center; padding: 40px; display: none;">
        <p style="color: #a0aec0;">ğŸ“­ æš‚æ— å¾…å¤„ç†éœ€æ±‚</p>
    </div>
</div>

<script>
    if(!localStorage.getItem('isLoggedIn')) { window.location.href = 'index.html'; }
    function logout() { localStorage.removeItem('isLoggedIn'); window.location.href = 'index.html'; }

    const data = JSON.parse(localStorage.getItem('reqData') || '[]');
    const tbody = document.getElementById('tableBody');

    if (data.length === 0) {
        document.getElementById('emptyState').style.display = 'block';
    } else {
        data.reverse().forEach(item => {
            const tr = document.createElement('tr');
            
            // ä¼˜å…ˆçº§æ ·å¼å¤„ç†
            let pClass = 'p-medium';
            let pText = 'é‡è¦';
            if(item.priority === 'low') { pClass = 'p-low'; pText = 'ä¸€èˆ¬'; }
            if(item.priority === 'high') { pClass = 'p-high'; pText = 'ç´§æ€¥'; }

            // å…¼å®¹æ—§æ•°æ®ï¼šå¦‚æœä¹‹å‰å­˜çš„æ˜¯projectNameï¼Œå°±æ˜¾ç¤ºåœ¨ç¬¬ä¸€åˆ—ï¼›å¦‚æœæ˜¯æ–°æ•°æ®titleï¼Œä¹Ÿæ˜¾ç¤ºåœ¨ç¬¬ä¸€åˆ—
            const displayTitle = item.title || item.projectName || 'æ— æ ‡é¢˜';
            
            // ç³»ç»Ÿåˆ†ç±»å­—æ®µ (å¦‚æœæ—§æ•°æ®æ²¡æœ‰ systemCategoryï¼Œåˆ™å°è¯•å– reqType æˆ–è€…æ˜¾ç¤ºä¸º '-')
            const displaySystem = item.systemCategory || (['Bugä¿®å¤','æ–°åŠŸèƒ½'].includes(item.reqType) ? '-' : item.reqType) || '-';

            tr.innerHTML = `
                <td style="font-weight: 600; color: #2d3748;">${displayTitle}</td>
                <td><span class="tag-system">${displaySystem}</span></td>
                <td><span class="tag-priority ${pClass}">${pText}</span></td>
                <td style="color: #718096;">${item.description}</td>
                <td>${item.submitter}</td>
                <td style="font-size: 12px; color: #a0aec0;">${item.dueDate || '-'}</td>
            `;
            tbody.appendChild(tr);
        });
    }
</script>

</body>
</html>
